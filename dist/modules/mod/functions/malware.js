"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const module_1 = require("../module");
const bannedExtensions = [
    "exe",
    "bat",
    "com",
    "msi",
    "vbs",
    "ps1",
    "zip",
    "rar",
    "7z",
    "docm",
    "xlsm",
    "pptm",
    "scr",
    "pif",
    "cmd",
];
function main({ attachments }) {
    // banned extension array
    const bannedExtensions = module_1.mod.config
        .get("fileTypeBlacklist")
        .replace(/ /g, "")
        .split(",");
    const files = [];
    // for each extension
    for (const att of attachments.values()) {
        for (const bannedExt of bannedExtensions) {
            if (att.name.split(".").includes(bannedExt))
                files.push(att);
        }
    }
    if (files.length > 0)
        return files;
}
exports.default = main;
//# sourceMappingURL=malware.js.map